{
  "name": "gameplay_loop",
  "strict": false,
  "schema": {
    "type": "object",
    "properties": {
      "narrative": {
        "type": "string",
        "description": "The AI-generated narrative response describing the player's action outcome, the world reaction, or new developments."
      },
      "actions": {
        "type": "object",
        "description": "Actions to update the game state based on the player's input and the narrative outcome.",
        "properties": {
          "createRegion": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "id": {
                "type": "string"
              },
              "description": {
                "type": "string"
              },
              "climate": {
                "type": "string"
              },
              "resources": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "levelTier": {
                "type": "integer"
              },
              "connectedRegions": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "name",
              "id",
              "description",
              "climate",
              "resources",
              "levelTier",
              "connectedRegions"
            ],
            "additionalProperties": false
          },
          "updateCharacter": {
            "type": "object",
            "properties": {
              "characterId": {
                "type": "string"
              },
              "newRegionId": {
                "type": "string"
              },
              "health": {
                "type": "integer"
              },
              "mana": {
                "type": "integer"
              },
              "statusEffects": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "characterId"
            ],
            "additionalProperties": false
          },
          "awardXp": {
            "type": "object",
            "properties": {
              "characterId": {
                "type": "string"
              },
              "amount": {
                "type": "integer"
              }
            },
            "required": [
              "characterId",
              "amount"
            ],
            "additionalProperties": false
          },
          "createNpc": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "npcId": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "role": {
                  "type": "string"
                },
                "description": {
                  "type": "string"
                },
                "regionId": {
                  "type": "string"
                }
              },
              "required": [
                "npcId",
                "name",
                "role",
                "description",
                "regionId"
              ],
              "additionalProperties": false
            }
          },
          "updateQuestStep": {
            "type": "object",
            "properties": {
              "characterId": {
                "type": "string"
              },
              "questId": {
                "type": "string"
              },
              "newStep": {
                "type": "integer"
              },
              "description": {
                "type": "string"
              }
            },
            "required": [
              "characterId",
              "questId",
              "newStep",
              "description"
            ],
            "additionalProperties": false
          },
          "lootDrop": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "itemId": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "quantity": {
                  "type": "integer"
                }
              },
              "required": [
                "itemId",
                "name",
                "quantity"
              ],
              "additionalProperties": false
            }
          },
          "worldEventTrigger": {
            "type": "object",
            "properties": {
              "eventId": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "description": {
                "type": "string"
              }
            },
            "required": [
              "eventId",
              "name",
              "description"
            ],
            "additionalProperties": false
          },
          "spawnEnemy": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "enemyId": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                },
                "level": {
                  "type": "integer"
                },
                "description": {
                  "type": "string"
                }
              },
              "required": [
                "enemyId",
                "name",
                "level",
                "description"
              ],
              "additionalProperties": false
            }
          },
          "levelUp": {
            "type": "object",
            "properties": {
              "characterId": {
                "type": "string"
              },
              "newLevel": {
                "type": "integer"
              },
              "gainedAbilities": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "characterId",
              "newLevel",
              "gainedAbilities"
            ],
            "additionalProperties": false
          },
          "updateConnectedRegions": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "regionId": {
                  "type": "string"
                },
                "addConnectedRegionId": {
                  "type": "string"
                }
              },
              "required": [
                "regionId",
                "addConnectedRegionId"
              ],
              "additionalProperties": false
            }
          },
          "travel": {
            "type": "object",
            "properties": {
              "characterId": {
                "type": "string"
              },
              "regionId": {
                "type": "integer"
              }
            },
            "required": [
              "characterId",
              "regionId"
            ],
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    },
    "required": [
      "narrative"
    ],
    "additionalProperties": false
  }
}